* $Id: test_drude_carbohydrate.str 28 2015-07-29 23:54:15Z alex $
* Test case, Drude carbohydrate toppar file
*

set boml 0 ! set to -1 if the series contains 3-membered rings

set nres 122

!polyols
set resi1 egly 
set seed1 1 O1 1 C1 1 C2
set resi2 mglyol 
set seed2 1 C1 1 C2 1 C3
set resi3 meryol
set seed3 1 C1 1 C2 1 C3
set resi4 dthrol
set seed4 1 C1 1 C2 1 C3
set resi5 lthrol
set seed5 1 C1 1 C2 1 C3
set resi6 mribol
set seed6 1 C1 1 C2 1 C3
set resi7 daraol
set seed7 1 C1 1 C2 1 C3
set resi8 laraol
set seed8 1 C1 1 C2 1 C3
set resi9 mxylol
set seed9 1 C1 1 C2 1 C3
set resi10 mallol 
set seed10 1 C1 1 C2 1 C3
set resi11 daltol
set seed11 1 C1 1 C2 1 C3
set resi12 laltol
set seed12 1 C1 1 C2 1 C3
set resi13 dgluol 
set seed13 1 C1 1 C2 1 C3
set resi14 lgluol
set seed14 1 C1 1 C2 1 C3
set seed15 1 C1 1 C2 1 C3
set resi15 dmanol
set seed15 1 C1 1 C2 1 C3
set resi16 lmanol
set seed16 1 C1 1 C2 1 C3
set resi17 dgulol 
set seed17 1 C1 1 C2 1 C3
set resi18 lgulol
set seed18 1 C1 1 C2 1 C3
set resi19 didiol 
set seed19 1 C1 1 C2 1 C3
set resi20 lidiol
set seed20 1 C1 1 C2 1 C3
set resi21 mgalol
set seed21 1 C1 1 C2 1 C3
!hexapyranoses
set resi22 aglc
set seed22 1 O5 1 C1 1 C2
set resi23 bglc
set seed23 1 O5 1 C1 1 C2
set resi24 aalt
set seed24 1 O5 1 C1 1 C2
set resi25 balt
set seed25 1 O5 1 C1 1 C2
set resi26 aall
set seed26 1 O5 1 C1 1 C2
set resi27 ball
set seed27 1 O5 1 C1 1 C2
set resi28 agal
set seed28 1 O5 1 C1 1 C2
set resi29 bgal
set seed29 1 O5 1 C1 1 C2
set resi30 agul
set seed30 1 O5 1 C1 1 C2
set resi31 bgul
set seed31 1 O5 1 C1 1 C2
set resi32 aido
set seed32 1 O5 1 C1 1 C2
set resi33 bido
set seed33 1 O5 1 C1 1 C2
set resi34 aman
set seed34 1 O5 1 C1 1 C2
set resi35 bman
set seed35 1 O5 1 C1 1 C2
set resi36 atal
set seed36 1 O5 1 C1 1 C2
set resi37 btal
set seed37 1 O5 1 C1 1 C2
!furanoses
set resi38 ARIB
set seed38 1 C4 1 O4 1 C1
set resi39 BRIB
set seed39 1 C4 1 O4 1 C1
set resi40 AARB
set seed40 1 C4 1 O4 1 C1
set resi41 BARB
set seed41 1 C4 1 O4 1 C1
set resi42 AXYF
set seed42 1 C4 1 O4 1 C1
set resi43 BXYF
set seed43 1 C4 1 O4 1 C1
set resi44 ALYF
set seed44 1 C4 1 O4 1 C1
set resi45 BLYF
set seed45 1 C4 1 O4 1 C1
set resi46 ADEO
set seed46 1 C4 1 O4 1 C1
set resi47 BDEO
set seed47 1 C4 1 O4 1 C1
set resi48 ALLO
set seed48 1 C1 1 C2 1 C3
set resi49 PSIC
set seed49 1 C1 1 C2 1 C3
set resi50 AFRU
set seed50 1 C5 1 O5 1 C2
set resi51 BFRU
set seed51 1 C5 1 O5 1 C2
!disac carbohydrate
set resi152 AARB
set resi252 AGLC
set patch52 PA11AA
set seed52  1 C4 1 O4 1 C1
set resi153 BARB
set resi253 AGLC
set patch53 PA11AB
set seed53  1 C4 1 O4 1 C1
set resi154 AARB
set resi254 BGLC
set patch54 PA11BA
set seed54  1 C4 1 O4 1 C1
set resi155 BARB
set resi255 BGLC
set patch55 PA11BB
set seed55  1 C4 1 O4 1 C1
set resi156 ARIB
set resi256 AGLC
set patch56 PA12AA
set seed56  1 C4 1 O4 1 C1
set resi157 AARB
set resi257 AGLC
set patch57 PA12AB
set seed57  1 C4 1 O4 1 C1
set resi158 BRIB
set resi258 BGLC
set patch58 PA12BA
set seed58  1 C4 1 O4 1 C1
set resi159 BARB
set resi259 BGLC
set patch59 PA12BB
set seed59  1 C4 1 O4 1 C1
set resi160 AARB
set resi260 AGLC
set patch60 PA13AA
set seed60  1 C4 1 O4 1 C1
set resi161 ALYF
set resi261 AGLC
set patch61 PA13AB
set seed61  1 C4 1 O4 1 C1
set resi162 AARB
set resi262 BGLC
set patch62 PA13BA
set seed62  1 C4 1 O4 1 C1
set resi163 BLYF
set resi263 BGLC
set patch63 PA13BB
set seed63  1 C4 1 O4 1 C1
set resi164 AARB
set resi264 AGLC
set patch64 PA15AB
set seed64  1 C4 1 O4 1 C1
set resi165 AARB
set resi265 BGLC
set patch65 PA15BB
set seed65  1 C4 1 O4 1 C1
set resi166 AARB
set resi266 AARB
set patch66 AA15AB
set seed66  1 C4 1 O4 1 C1
set resi167 AARB
set resi267 BARB
set patch67 AA15BB
set seed67  1 C4 1 O4 1 C1
set resi168 AGLC
set resi268 AGLC
set patch68 11AA
set seed68  1 O5 1 C1 1 C2
set resi169 AGLC
set resi269 BGLC
set patch69 11AB
set seed69  1 O5 1 C1 1 C2
set resi170 BGLC
set resi270 BGLC
set patch70 11BB
set seed70  1 O5 1 C1 1 C2
set resi171 AMAN
set resi271 AMAN
set patch71 12AA
set seed71  1 O5 1 C1 1 C2
set resi172 BGAL
set resi272 AGAL
set patch72 12AB
set seed72  1 O5 1 C1 1 C2
set resi173 AMAN
set resi273 BMAN
set patch73 12BA
set seed73  1 O5 1 C1 1 C2
set resi174 BGLC
set resi274 BGLC
set patch74 12BB
set seed74  1 O5 1 C1 1 C2
set resi175 AGUL
set resi275 AGUL
set patch75 13AA
set seed75  1 O5 1 C1 1 C2
set resi176 BMAN
set resi276 AMAN
set patch76 13AB
set seed76  1 O5 1 C1 1 C2
set resi177 AGUL
set resi277 BGUL
set patch77 13BA
set seed77  1 O5 1 C1 1 C2
set resi178 BGAL
set resi278 BGAL
set patch78 13BB
set seed78  1 O5 1 C1 1 C2
set resi179 BGAL
set resi279 AGAL
set patch79 14AA
set seed79  1 O5 1 C1 1 C2
set resi180 AGLC
set resi280 AGLC
set patch80 14AB
set seed80  1 O5 1 C1 1 C2
set resi181 BGAL
set resi281 BGAL
set patch81 14BA
set seed81  1 O5 1 C1 1 C2
set resi182 BGLC
set resi282 BGLC
set patch82 14BB
set seed82  1 O5 1 C1 1 C2
set resi183 AGLC
set resi283 AGLC
set patch83 16AB
set seed83  1 O5 1 C1 1 C2
set resi184 AGLC
set resi284 BGLC
set patch84 16BB
set seed84  1 O5 1 C1 1 C2
set resi185 AGLC
set resi285 AFRU
set patch85 FP21AA
set seed85  1 O5 1 C1 1 C2
set resi186 AGLC
set resi286 BFRU
set patch86 FP21AB
set seed86  1 O5 1 C1 1 C2
set resi187 BGLC
set resi287 AFRU
set patch87 FP21BA
set seed87  1 O5 1 C1 1 C2
set resi188 BGLC
set resi288 BFRU
set patch88 FP21BB
set seed88  1 O5 1 C1 1 C2
set resi189 AFRU
set resi289 AGLC
set patch89 16AB
set seed89  1 C5 1 O5 1 C2
set resi190 BFRU
set resi290 BGLC
set patch90 16BB
set seed90  1 C5 1 O5 1 C2
set resi191 AFRU
set resi291 AFRU
set patch91 FF26AB
set seed91  1 C5 1 O5 1 C2
set resi192 AFRU
set resi292 BFRU
set patch92 FF26BB
set seed92  1 C5 1 O5 1 C2
set resi193 AFRU
set resi293 AFRU
set patch93 FF21AB
set seed93  1 C5 1 O5 1 C2
set resi194 AFRU
set resi294 BFRU
set patch94 FF21AB
set seed94  1 C5 1 O5 1 C2
set resi195 BFRU
set resi295 AFRU
set patch95 FF21BB
set seed95  1 C5 1 O5 1 C2
set resi196 BFRU
set resi296 BFRU
set patch96 FF21BB
set seed96  1 C5 1 O5 1 C2
set resi197 BFRU
set resi297 AGLC
set patch97 PF13AB
set seed97  1 C5 1 O5 1 C2
set resi198 BFRU
set resi298 BGAL
set patch98 PF14BA
set seed98  1 C5 1 O5 1 C2
set resi199 AGLC
set resi299 AARB
set patch99 AP12AA
set seed99  1 O5 1 C1 1 C2
set resi1100 AMAN
set resi2100 AARB
set patch100 AP12AB
set seed100  1 O5 1 C1 1 C2
set resi1101 AGLC
set resi2101 BARB
set patch101 AP12BA
set seed101  1 O5 1 C1 1 C2
set resi1102 BMAN
set resi2102 BARB
set patch102 AP12BB
set seed102  1 O5 1 C1 1 C2
set resi1103 AGUL
set resi2103 AARB
set patch103 AP13AA
set seed103  1 O5 1 C1 1 C2
set resi1104 AMAN
set resi2104 AARB
set patch104 AP13AB
set seed104  1 O5 1 C1 1 C2
set resi1105 AGUL
set resi2105 BARB
set patch105 AP13BA
set seed105  1 O5 1 C1 1 C2
set resi1106 BMAN
set resi2106 BARB
set patch106 AP13BB
set seed106  1 O5 1 C1 1 C2
set resi1107 AGAL
set resi2107 AARB
set patch107 AP14AA
set seed107  1 O5 1 C1 1 C2
set resi1108 AGLC
set resi2108 AARB
set patch108 AP14AB
set seed108  1 O5 1 C1 1 C2
set resi1109 AGAL
set resi2109 BARB
set patch109 AP14BA
set seed109  1 O5 1 C1 1 C2
set resi1110 BGLC
set resi2110 BARB
set patch110 AP14BB
set seed110  1 O5 1 C1 1 C2
set resi1111 BGLC
set resi2111 AARB
set patch111 AP12AA
set seed111  1 O5 1 C1 1 C2
set resi1112 BMAN
set resi2112 AARB
set patch112 AP12AB
set seed112  1 O5 1 C1 1 C2
set resi1113 BGLC
set resi2113 BARB
set patch113 AP12BA
set seed113  1 O5 1 C1 1 C2
set resi1114 AMAN
set resi2114 BARB
set patch114 AP12BB
set seed114  1 O5 1 C1 1 C2
set resi1115 BGUL
set resi2115 AARB
set patch115 AP13AA
set seed115  1 O5 1 C1 1 C2
set resi1116 BMAN
set resi2116 AARB
set patch116 AP13AB
set seed116  1 O5 1 C1 1 C2
set resi1117 BGUL
set resi2117 BARB
set patch117 AP13BA
set seed117  1 O5 1 C1 1 C2
set resi1118 AMAN
set resi2118 BARB
set patch118 AP13BB
set seed118  1 O5 1 C1 1 C2
set resi1119 BGAL
set resi2119 AARB
set patch119 AP14AA
set seed119  1 O5 1 C1 1 C2
set resi1120 BGLC
set resi2120 AARB
set patch120 AP14AB
set seed120  1 O5 1 C1 1 C2
set resi1121 BGAL
set resi2121 BARB
set patch121 AP14BA
set seed121  1 O5 1 C1 1 C2
set resi1122 AGLC
set resi2122 BARB
set patch122 AP14BB
set seed122  1 O5 1 C1 1 C2



set count 1
label loop_carb1

if @count .le. 51 then
set residue @resi@@count
read sequence @residue 1

bomlev @boml
generate @residue first none last none setup warn drude dmass 0.4 !show
bomlev 0

else
read sequ card
*
2
@resi1@@count @resi2@@count
generate disa first none last none setup warn drude dmass 0.4 !show
patch @patch@@count disa 1 disa 2 setup warn drude dmass 0.4
bomlev 0
endif

ic param
ic seed @seed@@count
ic build 
coor sdrude
coor shake

! instead of relaxing Drude, move all Drude a little bit away from their parent atom
coor trans xdir -0.002 ydir -0.002 zdir -0.002 sele type D* end

update inbfrq -1 ihbfrq 0 switch atom vatom vswitch cutnb 999.0 ctofnb 997.0 ctonnb 995.0

if @mindr eq 0 then
  energy
 else
  cons harm force 100000. sele .not. type D* end
  mini ABNR nstep 200 nprint 20
  cons harm clear
 endif

 if @count .le. 51 then 
echo @residue starting E: ?ener
else
echo @resi1@@count-@resi2@@count-@patch@@count starting  E:  ?ener
endif
if @?pdbdir eq 1 then
  write psf card name @pdbdir/@residue.psf
  write coor pdb name @pdbdir/@residue_start.pdb
 endif

if @mini ne 0 then
  mini sd nstep 1000 tolgrd 0.0001 nprint 100
  if ?grms gt 0.0001 mini abnr nstep 1000 tolgrd 0.0001
  if ?grms gt 0.0001 then
    echo FATAL ERROR: MINIMIZATION NOT CONVERGED
    echu
    echo FATAL ERROR: MINIMIZATION NOT CONVERGED
    stop
   endif
  if @count .le. 51 then 
    echo @residue minimized E: ?ener
  else
    echo @resi1@@count-@resi2@@count-@patch@@count minimized  E:  ?ener
  endif  
  if @?pdbdir eq 1 then ! cannot use 1-line syntax because substitution will fail
    write coor pdb name @pdbdir/@residue_min.pdb
   endif
 endif

coor orient
coor dipole oxyz select all end 
echo @residue dipole: ?rdip
!! Check molecular polarizability
!VIBRAN
!diag dscf fini step 0.001
!END

shake off
drude reset
lone clear
delete atom sele all end

incr count
if count le @nres goto loop_carb1
